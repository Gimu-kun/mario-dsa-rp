@page "/challenge/knap-sack/selecting"
@model mario_dsa_rp.Pages.SelectingModel
@{
    Layout = "_Layout";
    ViewData["Title"] = "Chọn chế độ chơi";
    var id = Guid.NewGuid();
}
<link rel="stylesheet" href="~/css/selection.style.css">

<div class="selecting-page">
    <!-- Mode 1: Single Player -->
    <div class="mode-container">
        <div class="mode-title-container">
            <div class="mode-title">
                Chơi đơn <br> Lập bảng quy hoạch động
            </div>
        </div>
        <div class="level-container">
            <a class="level-button easy" href="/challenge/knap-sack/play/dynamic-board?difficult=easy&mode=single&id=@id">
                Dễ
            </a>
            <a class="level-button advance" href="/challenge/knap-sack/play/dynamic-board?difficult=medium&mode=single&id=@id">
                Trung Bình
            </a>
            <a class="level-button hard" href="/challenge/knap-sack/play/dynamic-board?difficult=hard&mode=single&id=@id">
                Khó
            </a>
        </div>
    </div>

    <!-- Mode 2: Multiplayer -->
    <div class="mode-container">
        <div class="mode-title-container">
            <div class="mode-title">
                Chơi 2 người<br>Lập bảng quy hoạch động
            </div>
        </div>
        <div class="level-container">
            <button type="button" class="level-button easy" onclick="createRoom('easy')">Dễ</button>
            <button type="button" class="level-button advance" onclick="createRoom('medium')">Trung Bình</button>
            <button type="button" class="level-button hard" onclick="createRoom('hard')">Khó</button>
        </div>
    </div>

    <!-- Sprite Mario -->
    <div class="sprite"></div>
</div>

@section Scripts{
<script>
    // Tạo GUID cho Room
    function guidv4() {
        return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {
            const r = Math.random() * 16 | 0,
                  v = c === 'x' ? r : (r & 0x3 | 0x8);
            return v.toString(16);
        });
    }
    
    // Khi host tạo phòng multiplayer
    function createRoom(difficult) {
        const roomId = guidv4();
        const Id = guidv4();
        // Điều hướng đến trang dynamic-board, mode = multiplay
        window.location.href = `/challenge/knap-sack/play/dynamic-board?id=${Id}&mode=multiplay&roomId=${roomId}&difficult=${difficult}`;
    }
</script>
}
